# C++ 随机函数教案（综合版：`<random>` 与 `rand/srand` 两条路线）

## 一、教学目标

1. 理解**真随机数**与**伪随机数**的概念与差异，知道计算机通常生成的是伪随机数。
2. 了解评价伪随机数发生器的重要指标—— **周期** 。
3. 掌握两种常见随机数生成方式：
   * 方式 A：`<random>` 中的 `random_device`（作为随机来源），配合取模生成指定范围
   * 方式 B：`rand()`/`srand()` 配合 `time(0)` 设置种子，并生成指定范围
4. 能够使用“取模 + 平移”方法生成指定区间整数与特定格式的小数，并能完成基础练习题。

---

## 二、重点与难点

* **重点** ：
* 伪随机/真随机的理解
* 种子（seed）的作用与“可复现/不可复现”
* 公式：([a,b]) 区间整数的生成方法
* **难点** ：
* 无符号类型与有符号类型转换的注意点
* `rand()` 的输出范围与 `RAND_MAX` 的含义

---

## 三、知识讲解

### 1. 伪随机数与真随机数

* **伪随机数（Pseudo-random）** ：看似随机，但本质由算法生成，具有
* **可重复性** ：相同初始状态/种子 → 相同序列
* **可预见性** ：若已知算法与内部状态，后续可推测
* **真随机数（True random）** ：来自非确定物理过程，具有
* **不可重复性** 、**不可预见性**

> 说明：计算机一般通过公式产生伪随机数。真随机数往往依赖物理噪声、放射性衰变等，工程实现成本更高。

---

### 2. 评价伪随机发生器的重要指标：周期

* **周期** ：随机序列最终会循环重复。周期越长，序列越不容易显露规律。
* 实际应用中，只要周期足够长、分布质量满足需求，伪随机就可以满足绝大多数场景。

---

## 四、两种生成方式对照教学

> 教学建议：先讲“取模 + 平移”统一思想，再分别在方式 A 与方式 B 中落地实现，让学生建立迁移能力。

---

# 五、方式 A：使用 `<random>`（现代 C++ 推荐）

## 1）`random_device` 与 `rd()`

* `random_device rd;`
* `rd()`：产生一个随机的 `unsigned int`（实现可能提供非确定性随机，也可能退化为伪随机；教材中常作为随机来源使用）

### 案例 A-1：产生 20 个随机无符号整数

```cpp
#include <iostream>
#include <random>
using namespace std;

int main() {
    random_device rd;
    for (int i = 0; i < 20; i++) {
        cout << rd() << endl;
    }
    return 0;
}
```

**扩展：生成有符号整数**

```cpp
cout << (int)rd() << endl;
// 或
int a = (int)rd();
cout << a << endl;
```

---

## 2）用取模控制范围（核心思想：取模 + 平移）

### 案例 A-2：产生 0~99 的随机整数

```cpp
cout << rd() % 100 << endl;  // 0..99
```

### 案例 A-3：产生 -20~10 的随机整数

```cpp
cout << (int)(rd() % 31) - 20 << endl;  // -20..10
```

 **注意** ：`rd()` 是无符号类型，建议 **先取余数再转 `int`** ，避免类型带来的理解偏差。

### 案例 A-4：产生 a~b 的随机整数（包含 a 和 b）

```cpp
cout << (int)(rd() % (b - a + 1)) + a << endl;  // a..b
```

说明：

* `b - a + 1` 是区间 `[a,b]` 内整数的个数
* `rd() % (b - a + 1)` 得到 `0..(b-a)`
* 再加 `a` 平移到 `a..b`

### 案例 A-5：产生 1.0~9.9 的随机浮点数（保留 1 位小数）

```cpp
cout << (rd() % 90 + 10) / 10.0 << endl;  // 1.0..9.9
```

说明：

先生成 `10..99` 的整数，再除以 `10.0` 得到 `1.0..9.9`，且仅一位小数。

---

# 六、方式 B：使用 `rand()` / `srand()`（传统方案，课件常见）

## 1）需要的头文件

* `#include <cstdlib>`：提供 `rand()`、`srand()`、`RAND_MAX`
* `#include <ctime>`：提供 `time()`

## 2）生成随机数的三步法（对应课件）

### 步骤① 引入头文件

```cpp
#include <cstdlib>
#include <ctime>
```

### 步骤② 设置随机种子

```cpp
srand(time(0));
```

说明：`time(0)` 返回从 **1970-01-01 00:00:00** 到当前的秒数（时间戳）。

使用当前时间作为种子，通常可让每次运行得到不同的随机序列。

> 注意：`srand(time(0))` 一般只调用一次，放在 `main()` 开头即可。

### 步骤③ 调用 `rand()`

* `rand()` 默认生成 `0 ~ RAND_MAX` 的整数
* 很多实现中 `RAND_MAX = 32767`（标准只保证其至少为 32767）

---

## 3）案例 B-1：打印 20 个 `rand()` 的值

```cpp
#include <iostream>
#include <cstdlib>
#include <ctime>
using namespace std;

int main() {
    srand(time(0));
    for (int i = 0; i < 20; i++) {
        cout << rand() << endl;
    }
    return 0;
}
```

## 4）用 `rand()` 生成指定范围（与方式 A 同套路）

### 案例 B-2：0~99

```cpp
int x = rand() % 100; // 0..99
```

### 案例 B-3：-20~10

```cpp
int x = rand() % 31 - 20; // -20..10
```

### 案例 B-4：a~b（包含 a、b）

```cpp
int x = rand() % (b - a + 1) + a; // a..b
```

### 案例 B-5：1.0~9.9（1 位小数）

```cpp
double x = (rand() % 90 + 10) / 10.0; // 1.0..9.9
```

---

## 七、两种方式对照小结（统一迁移公式）

* 方式 A：`random_device rd; rd()` 直接得到一个 `unsigned int`，再用 `%` 控制范围
* 方式 B：`srand(time(0)); rand()` 先设种子，再得到 `0..RAND_MAX` 的整数，同样用 `%` 控制范围

统一生成区间 ([a,b]) 的公式（包含端点）：

* ([a,b])：`X % (b - a + 1) + a`

其中 `X` 可以是 `rd()` 或 `rand()`。

---

## 八、课堂练习（含答案）

### 练习 1：生成 50~80 的随机整数（包含端点）

**答案：**

* 用 `rand()`：

```cpp
int x = rand() % 31 + 50;
```

* 用 `rd()`：

```cpp
int x = (int)(rd() % 31) + 50;
```

---

### 练习 2：生成 -3~3 的随机整数

**答案：**

* 用 `rand()`：

```cpp
int x = rand() % 7 - 3;
```

* 用 `rd()`：

```cpp
int x = (int)(rd() % 7) - 3;
```

---

### 练习 3：生成 2.5~7.5，步长 0.1（保留 1 位小数）

提示：先生成 `25..75` 的整数，再除以 `10.0`。

**答案：**

* 用 `rand()`：

```cpp
double x = (rand() % 51 + 25) / 10.0;
```

* 用 `rd()`：

```cpp
double x = (rd() % 51 + 25) / 10.0;
```

---

## 九、课后小结

1. 计算机通常生成伪随机数；真随机数依赖物理过程。
2. 伪随机的重要指标之一是周期。
3. `rd()` 与 `rand()` 都可配合“取模 + 平移”生成指定范围随机数。
4. `rand()` 方案要记得：先 `srand(time(0))` 再 `rand()`，且 `srand` 通常只调用一次。
