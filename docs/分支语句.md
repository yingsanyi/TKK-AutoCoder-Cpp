3. 选择结构——程序的“大脑”
会了“真/假判断”之后，程序还要学会：
碰到不同情况，走不同路线 —— 这就是选择结构（分支）。
下面用更贴近日常 + 稍微“高级”一点的场景来讲：网络登录、推荐内容、计费、权限控制等。

---
3.1 单分支：直肠子（if）
只关注一种情况：
“如果发生了，就处理一下；否则就当没发生，保持现状。”
3.1.1 场景：用户首次登录送新人礼包
- 场景：某 App 想在用户第一次登录时送一份新人礼包，以后再登录就不要重复送了。
- 逻辑： 
  - 如果是首次登录：发放礼包；
  - 否则：什么都不做，按正常流程走。
bool isFirstLogin = true; // 从数据库查出来的标记

if (isFirstLogin) {
    giveWelcomeGift();   // 发新人礼包
    // 后面一般还会把 isFirstLogin 改成 false，防止重复送
}
不满足条件时：if 里的代码直接跳过，程序继续执行后面的逻辑。
3.1.2 现实生活例子：办公楼刷卡
- 场景：进办公室需要刷门禁卡。
- 逻辑： 
  - 如果刷卡失败：响一声“滴”、提示重刷；
  - 否则：不提示，默认就当你进去了。
bool authFailed = true; // 校验门禁卡失败

if (authFailed) {
    cout << "刷卡失败，请重试" << endl;
}
只有“出问题”时才需要打断流程，正常情况什么也不说，这就是典型单分支 if。
【小练习 3.1】
1. 用单分支 if 写出逻辑： 
  - “如果用户余额小于 0，就输出 账户欠费，请及时充值”。变量名 balance。
2. 看代码：score = 90 时会不会输出东西？
int score = 90;

if (score > 100) {
    cout << "你太强了" << endl;
}
参考答案：
1. 
if (balance < 0) {
    cout << "账户欠费，请及时充值" << endl;
}
2. 条件 score > 100 为 false，所以不会输出任何内容。

---
3.2 双分支：二选一（if-else）
有了两套方案，必须二选一。
“如果满足条件，走方案 A；否则一定走方案 B。”
3.2.1 场景：白天模式 / 夜间模式
- 场景：根据时间自动切换 App 主题： 
  - 白天：浅色模式；
  - 晚上：深色模式。
int hour = 21; // 24 小时制，0~23

if (hour >= 7 && hour < 19) {
    setLightTheme();  // 白天：浅色主题
} else {
    setDarkTheme();   // 其余时间：深色主题
}
无论几点钟，一定会走其中一个分支。
3.2.2 场景：判定请求是“内部访问”还是“外部访问”
- 场景：服务端根据 IP 判断，这是公司内网还是外网访问。
- 逻辑： 
  - 如果 IP 在内网网段：输出“内部访问”；
  - 否则：输出“外部访问”。
bool isIntranetIP = checkIntranet(ip); // 假设这是一个函数

if (isIntranetIP) {
    cout << "内部访问" << endl;
} else {
    cout << "外部访问" << endl;
}
【小练习 3.2】
1. 写一个 if-else： 
  - “如果用户是 VIP，运费为 0；否则运费为 10 元”。变量： 
    - bool isVIP;
    - int shippingFee;
2. 当 age = 65 时，这段代码会输出什么？
int age = 65;

if (age < 60) {
    cout << "普通票" << endl;
} else {
    cout << "老年优惠票" << endl;
}
参考答案：
1. 
if (isVIP) {
    shippingFee = 0;
} else {
    shippingFee = 10;
}
2. age < 60 为 false，走 else，输出：
老年优惠票

---
3.3 多分支：层层筛选（if - else if - else）
一个条件不够用时，需要多级决策。
 可以想象成：从“总控台”一路往下查，先排除特殊情况，再分类处理。
3.3.1 场景：推荐内容等级（个性化推荐）
- 场景：根据用户活跃度打标签： 
  1. 活跃度数据异常：提示“数据错误”；
  2. 活跃度 ≥ 90：标记为“重度用户”；
  3. 活跃度 ≥ 60：标记为“活跃用户”；
  4. 活跃度 ≥ 30：标记为“一般用户”；
  5. 其余：标记为“沉睡用户”。
int activeScore = 72; // 0~100，系统统计的活跃度分数

if (activeScore < 0 || activeScore > 100) {
    cout << "活跃度数据错误" << endl;
} else if (activeScore >= 90) {
    cout << "重度用户" << endl;
} else if (activeScore >= 60) {
    cout << "活跃用户" << endl;
} else if (activeScore >= 30) {
    cout << "一般用户" << endl;
} else {
    cout << "沉睡用户" << endl;
}
理解关键点：
- 只会命中第一个满足条件的分支。
- 范围式判断时，推荐从“更严格、范围更高”往下写。
3.3.2 场景：计费规则（网约车简化版）
- 场景：根据里程给出计费策略（极简版假设）： 
  1. 里程 < 0：数据错误；
  2. 里程 ≤ 3 公里：起步价 10 元；
  3. 里程 ≤ 10 公里：中距离，每公里 2 元；
  4. 里程 > 10 公里：长途，每公里 1.5 元。
double distance = 8.5; // 单位：公里
double price = 0;

if (distance < 0) {
    cout << "里程数据错误" << endl;
} else if (distance <= 3) {
    price = 10;
} else if (distance <= 10) {
    price = 10 + (distance - 3) * 2; // 超出部分每公里 2 元
} else {
    price = 10 + (10 - 3) * 2 + (distance - 10) * 1.5;
}

cout << "本次车费：" << price << " 元" << endl;
【小练习 3.3】
1. 设定一个变量 int cpuUsage 表示 CPU 利用率（0–100），按下面规则输出状态： 
  - < 0 或 > 100：输出“数据错误”；
  - 0–30：输出“空闲”；
  - 31–70：输出“正常”；
  - 71–90：输出“繁忙”；
  - 91–100：输出“过载警告”；
2. 思考：如果你把“空闲”（0–30）那一行写成 else if (cpuUsage >= 0) 并放在最前面，会发生什么？
参考答案（思路）：
1. 结构示意：
if (cpuUsage < 0 || cpuUsage > 100) {
    cout << "数据错误" << endl;
} else if (cpuUsage <= 30) {
    cout << "空闲" << endl;
} else if (cpuUsage <= 70) {
    cout << "正常" << endl;
} else if (cpuUsage <= 90) {
    cout << "繁忙" << endl;
} else {
    cout << "过载警告" << endl;
}
2. 如果最前面写 else if (cpuUsage >= 0)： 
  - 只要数据合法(≥0)，永远会先命中这一行，后面“正常 / 繁忙 / 过载”都永远不会执行。
  - 说明：多分支时，条件顺序非常重要。

---
3.4 switch 语句：对号入座
当“条件”是几个固定选项（例如状态码、菜单编号、操作类型）时，switch 比一长串 if-else 更清爽。
你可以把它理解成“多路开关”：值是多少，就自动切换到哪一路。
3.4.1 场景：根据状态码打印提示
- 场景：网络请求结束后，服务器返回状态码： 
  - 200：成功
  - 400：参数错误
  - 401：未登录
  - 500：服务器内部错误
  - 其他：未知错误
int code = 401;

switch (code) {
case 200:
    cout << "请求成功" << endl;
    break;
case 400:
    cout << "参数错误" << endl;
    break;
case 401:
    cout << "未登录或登录已失效" << endl;
    break;
case 500:
    cout << "服务器内部错误" << endl;
    break;
default:
    cout << "未知错误，错误码：" << code << endl;
    break;
}
3.4.2 场景：键盘快捷键处理（简化版）
- 场景：根据用户按下的字母，执行不同命令： 
  - N：新建
  - S：保存
  - Q：退出
  - 其他：无效命令
char cmd = 'S';

switch (cmd) {
case 'N':
    cout << "新建文件" << endl;
    break;
case 'S':
    cout << "保存文件" << endl;
    break;
case 'Q':
    cout << "退出程序" << endl;
    break;
default:
    cout << "无效命令" << endl;
    break;
}
3.4.3 break 的“穿透”效果
如果不写 break，switch 会从命中的 case 一路往下执行，直到遇到 break 或 switch 结束。
int level = 2;

switch (level) {
case 1:
    cout << "青铜权限" << endl;
case 2:
    cout << "白银权限" << endl;
case 3:
    cout << "黄金权限" << endl;
}
- level == 2，从 case 2 开始执行，先打印“白银权限”，
- 接着没有 break，往下执行 case 3，再打印“黄金权限”，
- 最终输出两行：
白银权限
黄金权限
大多数时候，我们不希望这样穿透，所以要在每个 case 结尾写上 break。
【小练习 3.4】
1. 用 switch 实现一个“语言选择”菜单： 
  - 输入 1：输出“中文”；
  - 输入 2：输出“English”；
  - 输入 3：输出“日本語”；
  - 其他：输出“Unsupported language”；
2. 用一句话说明：什么时候你更推荐用 switch 而不是 if-else？
参考答案（思路）：
1. 结构示例：
int lang;
cin >> lang;

switch (lang) {
case 1:
    cout << "中文" << endl;
    break;
case 2:
    cout << "English" << endl;
    break;
case 3:
    cout << "日本語" << endl;
    break;
default:
    cout << "Unsupported language" << endl;
    break;
}
2. 当判断条件是有限个离散值（如状态码、菜单号、字符指令），并且只是做“对号入座”式的处理时，用 switch 比长串 if-else 更清晰、更易读。